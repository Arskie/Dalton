MONTH_LOANRENEW


mysql = "CREATE VIEW MONTHLY_LOANRENEW( "
mySql &= vbcrlf &  "  LOANDATE, "
mySql &= vbcrlf &  "  CEL_COUNT, "
mySql &= vbcrlf &  "  CEL_PRINCIPAL, "
mySql &= vbcrlf &  "  JWL_COUNT, "
mySql &= vbcrlf &  "  JWL_PRINCIPAL, "
mySql &= vbcrlf &  "  APP_COUNT, "
mySql &= vbcrlf &  "  APP_PRINCIPAL, "
mySql &= vbcrlf &  "  LOAN_COUNT, "
mySql &= vbcrlf &  "  LOAN_PRINCIPAL, "
mySql &= vbcrlf &  "  RENEW_COUNT, "
mySql &= vbcrlf &  "  RENEW_PRINCIPAL) "
mySql &= vbcrlf &  "AS "
mySql &= vbcrlf &  "SELECT LOANDATE,  "
mySql &= vbcrlf &  "	SUM(CASE WHEN ITEMTYPE = 'CEL' AND STATUS = 'L' THEN 1 ELSE 0 END) AS CEL_COUNT, "
mySql &= vbcrlf &  "    SUM(CASE WHEN ITEMTYPE = 'CEL' AND STATUS = 'L' THEN PRINCIPAL ELSE 0 END) AS CEL_PRINCIPAL, "
mySql &= vbcrlf &  "    SUM(CASE WHEN ITEMTYPE = 'JWL' AND STATUS = 'L' THEN 1 ELSE 0 END) AS JWL_COUNT, "
mySql &= vbcrlf &  "    SUM(CASE WHEN ITEMTYPE = 'JWL' AND STATUS = 'L' THEN PRINCIPAL ELSE 0 END) AS JWL_PRINCIPAL, "
mySql &= vbcrlf &  "    SUM(CASE WHEN ITEMTYPE = 'APP' AND STATUS = 'L' THEN 1 ELSE 0 END) AS APP_COUNT, "
mySql &= vbcrlf &  "    SUM(CASE WHEN ITEMTYPE = 'APP' AND STATUS = 'L' THEN PRINCIPAL "
mySql &= vbcrlf &  "    WHEN ITEMTYPE = 'BIG' AND STATUS = 'L' THEN PRINCIPAL ELSE 0 END) AS APP_PRINCIPAL, "
mySql &= vbcrlf &  "    SUM(CASE STATUS WHEN 'L' THEN 1 ELSE 0 END) AS LOAN_COUNT, "
mySql &= vbcrlf &  "    SUM(CASE STATUS WHEN 'L' THEN PRINCIPAL ELSE 0 END) AS LOAN_PRINCIPAL, "
mySql &= vbcrlf &  "    SUM(CASE STATUS WHEN '0' THEN 1 WHEN 'R' THEN 1 ELSE 0 END) AS RENEW_COUNT, "
mySql &= vbcrlf &  "    SUM(CASE STATUS WHEN '0' THEN PRINCIPAL "
mySql &= vbcrlf &  "    WHEN 'R' THEN PRINCIPAL ELSE 0 END) AS RENEW_PRINCIPAL "
mySql &= vbcrlf &  "FROM TBLPAWN "
mySql &= vbcrlf &  "WHERE (STATUS = 'L' OR STATUS = '0' OR STATUS = 'R') "
mySql &= vbcrlf &  "GROUP BY 1"